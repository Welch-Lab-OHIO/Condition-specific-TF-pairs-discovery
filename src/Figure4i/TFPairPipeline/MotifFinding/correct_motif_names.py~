import pandas as pd
import sys, os

if not len(sys.argv) == 2:
    print("command filename")
    sys.exit(-1)
out_file = pd.read_csv(f"{sys.argv[1]}.bed", 
names=["chromosome", "start", "stop", "name", "temp1", "temp2"],
sep="\t", index_col=False)

motif_file = pd.read_csv("MOUSE_mono_motifs.tsv",
sep="\t", index_col=False)
motif_file["Transcription factor"] = motif_file.apply(lambda x: x["Transcription factor"].split(":")[1],axis=1)
mapping = motif_file["Transcription factor"]
mapping = mapping.set_axis(motif_file["Model"])
mapping = mapping.to_dict()
out_file["name"] = out_file.apply(lambda x: mapping[x["name"]], axis=1)
out_file.to_csv(f"{sys.argv[1]}.corrected.bed", sep="\t", header=False, index=False)